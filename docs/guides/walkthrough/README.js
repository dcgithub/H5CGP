Ext.data.JsonP.walkthrough({"guide":"<h1 id='walkthrough-section-h5cgb-basics-walkthrough---build-a-platformer'>H5CGB Basics Walkthrough - Build a Platformer</h1>\n<div class='toc'>\n<p><strong>Contents</strong></p>\n<ol>\n<li><a href='#!/guide/walkthrough-section-default-project%3A-main.js'>Default Project: main.js</a></li>\n<li><a href='#!/guide/walkthrough-section-side-scrolling'>Side-Scrolling</a></li>\n<li><a href='#!/guide/walkthrough-section-boxes%2C-collision%2C-and-images'>Boxes, Collision, and Images</a></li>\n<li><a href='#!/guide/walkthrough-section-tilemaps'>TileMaps</a></li>\n<li><a href='#!/guide/walkthrough-section-sprites-and-spritemaps'>Sprites and SpriteMaps</a></li>\n<li><a href='#!/guide/walkthrough-section-inheritance%2C-keyboard-input%2C-collections%2C-and-fireballs'>Inheritance, Keyboard Input, Collections, and Fireballs</a></li>\n<li><a href='#!/guide/walkthrough-section-layers'>Layers</a></li>\n<li><a href='#!/guide/walkthrough-section-exercises-for-the-reader'>Exercises for the Reader</a></li>\n<li><a href='#!/guide/walkthrough-section-recap'>Recap</a></li>\n</ol>\n</div>\n\n<p>This guide introduces the rapid prototyping tools for JavaScript canvas\napplications provided by\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate\">HTML5 Canvas Game Boilerplate</a>\nby using them to write a Mario-style platformer game.</p>\n\n<h2 id='walkthrough-section-default-project%3A-main.js'>Default Project: main.js</h2>\n\n<p>H5CGB provides a lot of boilerplate out of the box, but there is really only\none file you need to focus on to write your application:\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/js/app/main.js\">main.js</a>.\n(You will probably also want to tweak\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/index.html\">index.html</a>,\nand possibly adjust its styling with\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/css/main.css\">main.css</a>.)\nFor the rest of this tutorial, all the code I'll be discussing goes in main.js\nunless noted otherwise.</p>\n\n<p>Although H5CGB is designed so that you should usually be able to write your\napplication without touching other files, you can dive in and modify other\nthings if you need to. The code is well-documented and there is lots of\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/wiki\">online documentation</a>,\nso you should be able to figure out how things work if you do want to change\nthe internals.</p>\n\n<p>All of main.js, by default, is well under 100 lines of code. It consists of the\nmagic functions <code>setup()</code>, <code>draw()</code>, and <code>update()</code>, which do pretty much what\nyou would expect. Your movement/collision/update code goes in <code>update()</code>;\npainting code goes in <code>draw()</code>; and setup goes in <code>setup()</code>. Here are the 20\nlines of code sans comments and blank lines:</p>\n\n<pre><code>var player;\nvar keys = {\n  up: ['up', 'w'],\n  down: ['down', 's'],\n  left: ['left', 'a'],\n  right: ['right', 'd'],\n};\nvar preloadables = [];\nfunction update() {\n  player.update();\n}\nfunction draw() {\n  context.drawCheckered(80, 0, 0, world.width, world.height);\n  player.draw();\n}\nfunction setup(first) {\n  world.resize(canvas.width + 200, canvas.height + 200);\n  Actor.prototype.GRAVITY = false;\n  player = new Player();\n}\n</code></pre>\n\n<p>If you go ahead and open index.html, here's what it will look like:</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/guides/walkthrough/screen00.png\" alt=\"The default index.html\" /></p>\n\n<p>You can see the movement keys specified in the code -- use WASD or the arrow\nkeys to move around and try it. Already you've got a player character that can\nmove around in a \"world\" that scrolls around as the player approaches an edge.\nWe've written no code and we have a top-down RPG. If there was some grass on\nthe ground instead of the checkerboard, we'd practically have\n<a href=\"https://en.wikipedia.org/wiki/Pok%C3%A9mon_%28video_game_series%29\">Pokémon</a>.\nBut I'm getting ahead of myself.</p>\n\n<p><em><a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/walkthrough00-default.js\">Review the code for this section</a></em></p>\n\n<h2 id='walkthrough-section-side-scrolling'>Side-Scrolling</h2>\n\n<p>We want to build a side-scrolling platformer, not a top-down adventure game, so\nwe need to make a simple change. See the line that says <code>GRAVITY</code> in it in\n<code>setup()</code>? Switch the value there to <code>true</code> to (<em>surprise</em>) enable\ngravity. Let's also change the size of our game world so our mustachioed\nadventurer has a little more room to run around, and let's place him at the\n\"beginning\" of the level instead of in the center.</p>\n\n<pre><code>// world.resize() changes the size of the world, in pixels; defaults to the canvas size\nworld.resize(canvas.width + 1200, canvas.height + 200);\n\n// the GRAVITY property enables gravity\nActor.prototype.GRAVITY = true;\n\n// the arguments to create a new player specify its pixel coordinates\n// upper-left is (0, 0)\nplayer = new Player(200, 200);\n</code></pre>\n\n<p>Refresh the page and you should see your smiley-face character fall to the\nground. Try jumping around a bit and moving to the sides so you can see that\nthe world still scrolls. Cool! (Note that all the movement mechanics are\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Actor\">configurable</a>.)</p>\n\n<p><em><a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/walkthrough01-scrolling.js\">Review the code for this section</a></em></p>\n\n<h2 id='walkthrough-section-boxes%2C-collision%2C-and-images'>Boxes, Collision, and Images</h2>\n\n<p>Mario would be no fun if he just ran around on flat terrain all the time. We\nneed platforms and things to jump over! Let's put a\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Box\">Box</a>\ninto the world. Put this at the bottom of <code>setup()</code>:</p>\n\n<pre><code>// Add terrain.\nsolid = new Box(world.height - Box.prototype.DEFAULT_HEIGHT, 400);\n</code></pre>\n\n<p>If you refresh the page, you'll notice your Box isn't visible. That's because\nwe're not drawing it yet. In the <code>draw()</code> function, add:</p>\n\n<pre><code>solid.draw();\n</code></pre>\n\n<p>We have a box!</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/guides/walkthrough/screen01.png\" alt=\"Mario plus a Box\" /></p>\n\n<p>Sadly, if you try running around, you'll notice that your player doesn't\ncollide with the box. Let's fix that. Replace the contents of update() with\nthis:</p>\n\n<pre><code>// move\nplayer.update();\n// enforce collision\nplayer.collideSolid(solid);\n</code></pre>\n\n<p>Success!</p>\n\n<p>Plain black boxes are okay, but let's spice it up a little by using an image. Just put this line after initializing the box during setup():</p>\n\n<pre><code>solid.src = 'path/to/image.png';\n</code></pre>\n\n<p>Here's the image I used:</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/examples/images/grass2.png\" alt=\"Grass\" /></p>\n\n<p>You should also add the image to the <code>preloadables</code> array at the top of main.js\nso that it is cached before animation starts:</p>\n\n<pre><code>var preloadables = ['path/to/image.png'];\n</code></pre>\n\n<p>Voilà!</p>\n\n<p><em><a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/walkthrough02-boxes.js\">Review the code for this section</a></em></p>\n\n<h2 id='walkthrough-section-tilemaps'>TileMaps</h2>\n\n<p>A world with one box isn't much of a world at all. Let's build some more\ninteresting terrain. Back in setup(), instead of adding a new Box, let's add a\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/TileMap\">TileMap</a>.\nTileMaps are basically helpers to initialize and manage grids of objects. Using\nthem is fairly intuitive:</p>\n\n<pre><code>// Add terrain.\nvar grid =  \"         B      BB        \\n\" +\n            \"              BBBBBB      \\n\" +\n            \"      BB    BBBBBBBBBB  BB\";\nsolid = new TileMap(grid, {B: Box});\n</code></pre>\n\n<p>You can probably tell what's going on here: the \"grid\" string represents our\nlayout, where spaces represent empty spaces and B's become new Boxes as\nspecified in the map we're passing to TileMap as the second parameter. There\nare a couple of different ways to initialize TileMaps, but this is the easiest.</p>\n\n<p>If you refresh the page you'll see that all the new boxes are drawn and your\nplayer collides with them. That's because we already had <code>solid.draw()</code> and\n<code>player.collideSolid(solid)</code> in our <code>draw()</code> and <code>update()</code> functions,\nrespectively, and those methods work the same way for TileMaps as they do for\nBoxes.</p>\n\n<p>Unfortunately our boxes are all black again. That's because when you initialize\na TileMap this way, it uses the default constructor for the objects it creates.\nThere are four common ways to do this, but the easiest is to simply pass the\nfile path of your image to the TileMap. Doing so will automatically create\nBox-like objects using that image.</p>\n\n<pre><code>solid = new TileMap(grid, {B: 'path/to/image.png'});\n</code></pre>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/guides/walkthrough/screen02.png\" alt=\"Textured TileMap\" /></p>\n\n<p>There are lots of fun things we can do with TileMaps; this is just a taste.</p>\n\n<p><strong>Quick recap:</strong> we've only added or changed around a dozen lines of code, and\nwe already have a character who can run/jump around and collide with textured\nobjects in a map layout.</p>\n\n<p><em><a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/walkthrough03-tilemaps.js\">Review the code for this section</a></em></p>\n\n<h2 id='walkthrough-section-sprites-and-spritemaps'>Sprites and SpriteMaps</h2>\n\n<p>Now, our smiley face is pretty sweet, but we can't go about smiling all the\ntime when we're stomping baddies. We need a hero with some expression. A hero\nwith <em>moves</em>. A hero like... <em>StickMan!</em></p>\n\n<p>Here's a simple sprite we'll use for testing sprite animation:</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/examples/images/player.png\" alt=\"StickMan\" /></p>\n\n<p>Whatever image you use, remember to add it to the <code>preloadables</code> array at the\ntop of main.js so that it will be loaded and cached before animation starts.</p>\n\n<p>Let's assign the sprite to our player in <code>setup()</code>. Notice that the sprite\nwe're using has several different animation sequences in it, so we'll use a\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/SpriteMap\">SpriteMap</a>\nto keep track of them. SpriteMaps are basically wrappers around\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Sprite\">Sprite</a>s\nthat make it easier to switch between different animation sequences. If you\njust have one animation sequence that you want to run continuously, you could\nassign a Sprite to <code>player.src</code> instead; you'd leave out the parameter that\nspecifies the animation sequences, but otherwise it works the same way.</p>\n\n<pre><code>// Notice the two new parameters to Player(); they are width and height.\n// We're changing the player's dimensions to match the width:height ratio of the image.\nplayer = new Player(200, 200, 60, 80);\n// Initialize the SpriteMap by giving it an image file, a map of animation sequences, and settings.\nplayer.src = new SpriteMap('path/to/image.png', {\n  stand: {\n    startRow: 0,\n    startCol: 5,\n    endRow: 0,\n    endCol: 5,\n  },\n  left: {\n    startRow: 0,\n    startCol: 0,\n    endRow: 0,\n    endCol: 4,\n  },\n  right: {\n    startRow: 1,\n    startCol: 0,\n    endRow: 1,\n    endCol: 4,\n  },\n  // More animation loops omitted for brevity...\n}, {\n  frameW: 30, // frame width\n  frameH: 40, // frame height\n  interval: 75, // time delay between switching frames\n  useTimer: false, // use the animation cycle instead of a setInterval() timer to update frames\n});\n</code></pre>\n\n<p>This is the long form of the <code>SpriteMap()</code> constructor. The map of animation\nsequences is easy to read &mdash; the outer keys are the names of the sequence,\nand the inner maps specify the starting and ending frames for each sequence.\nThis can get long and tedious to write out though, so there's a more concise\nversion as well:</p>\n\n<pre><code>player = new Player(200, 200, 60, 80);\nplayer.src = new SpriteMap('path/to/image.png', {\n  stand: [0, 5, 0, 5],\n  fall: [0, 5, 1, 5, true],\n  left: [0, 0, 0, 4],\n  right: [1, 0, 1, 4],\n  lookLeft: [0, 2, 0, 2],\n  lookRight: [1, 2, 1, 2],\n  jumpLeft: [0, 4, 0, 4],\n  jumpRight: [1, 4, 1, 4],\n}, {\n  frameW: 30,\n  frameH: 40,\n  interval: 75,\n  useTimer: false,\n});\n</code></pre>\n\n<p>Much shorter, and still not to bad to read. Hooray, StickMan!</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/screen03.png\" alt=\"StickMan has arrived\" /></p>\n\n<p>If you copied the code above, you may be surprised to see that your animations\nalready work. That's because there are certain magic-named animation sequences\nthat run automatically. If you want to add animations that aren't covered, use\ndifferent names for the animation sequences, or run the animations at different\ntimes, you can override the\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Actor-method-updateAnimation\"><code>updateAnimation()</code></a>\nmethod from the Actor class (that link goes to the documentation for that\nmethod, which lists the magic animation sequence names). More on inheritance\nbelow.</p>\n\n<p><em><a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/walkthrough04-sprites.js\">Review the code for this section</a></em></p>\n\n<h2 id='walkthrough-section-inheritance%2C-keyboard-input%2C-collections%2C-and-fireballs'>Inheritance, Keyboard Input, Collections, and Fireballs</h2>\n\n<p>Fire! Balls! Balls of fire! Time to shoot some fireballs. In order to do this,\nwe're going to listen for the \"shoot\" button to be pressed, create a new\ninstance of a Bullet class we'll create, and add that instance to a set of all\nour bullets for easier maintenance. This will be by far the most code we'll\nneed to add.</p>\n\n<p>First, above <code>update()</code>, let's create a set that we'll use to keep track of the\nbullets we've fired:</p>\n\n<pre><code>/**\n * All our Bullets.\n */\nvar bullets = new Collection();\n</code></pre>\n\n<p><a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Collection\">Collection</a>s\nare sets of things. They let you keep track of them easily and perform\noperations on all the items in the set at once. They're a lot like TileMaps\nexcept they don't keep track of their items' placement relative to each other.</p>\n\n<p>Next, let's create a Bullet class. We have a class/inheritance framework\navailable to us as\n<a href=\"http://ejohn.org/blog/simple-javascript-inheritance/\">defined by John Resig</a>\n(creator of jQuery). New child classes are created using the\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Class\"><code>Class.extend()</code></a>\nmethod, and the <code>init()</code> method of the new class runs when it is instantiated.\nWe've already been using the\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Box\">Box</a>\nclass, which is the parent of most things you'll want to put in your world, and the\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Player\">Player</a>\nclass, which is controlled by the user's keyboard. Player inherits from\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Actor\">Actor</a>,\nwhich is a child of Box that adds movement mechanics. We're going to extend\nActor with a new class called Bullet.</p>\n\n<pre><code>/**\n * The Bullet class.\n */\nvar Bullet = Actor.extend({\n  // Override Actor default properties.\n  MOVEAMOUNT: 800, // Bullet velocity in pixels per second\n  GRAVITY: false, // Just keep going rather than falling down\n  CONTINUOUS_MOVEMENT: true, // Keep going in the last specified direction\n  STAY_IN_WORLD: false, // Let our bullets leave the world (we'll destroy them when they do)\n  DEFAULT_WIDTH: 10,\n  DEFAULT_HEIGHT: 10,\n  /**\n   * Initialize a Bullet.\n   *\n   * @param direction\n   *   An array of keys representing the Bullet's initial direction.\n   * @param x\n   *   The x-coordinate of the top-left corner of the Bullet.\n   * @param y\n   *   The y-coordinate of the top-left corner of the Bullet.\n   */\n  init: function(direction, x, y) {\n    // Invoke the parent's init() function, Actor.prototype.init().\n    this._super(x, y);\n    // Store the direction we want the bullet to go. The CONTINUOUS_MOVEMENT\n    // setting uses this property to keep going in the specified direction.\n    this.lastLooked = direction;\n  },\n  /**\n   * Override drawDefault() to draw a bullet when there isn't an image associated with it (src === null).\n   */\n  drawDefault: function(ctx, x, y, w, h) {\n    // This draws a circle onto the graphics context (i.e. the canvas).\n    // Parameters are x-coordinate of center, y-coordinate of center, radius, fill color, border color\n    ctx.circle(x + w/2, y + w/2, (w + h) / 4, 'orange', 'black');\n  },\n});\n</code></pre>\n\n<p>That wasn't so bad. We really just needed to override a few settings from Actor\nand to make sure we store the bullet's direction. Now we're ready to create new\nbullets when the player presses the \"shoot\" button. First, let's actually\ndefine what the shoot button is. At the top, where the <code>keys</code> object is\ndefined, add your shoot key:</p>\n\n<pre><code>var keys = {\n  up: ['up', 'w'],\n  down: ['down', 's'],\n  left: ['left', 'a'],\n  right: ['right', 'd'],\n  shoot: ['space'], // Add this one\n};\n</code></pre>\n\n<p>Now let's listen for that key to be pressed. We're also going to put in a rate limit. Put this code after your Bullet class:</p>\n\n<pre><code>/**\n * The minimum number of milliseconds that must pass between firing bullets.\n *\n * Set to 0 (zero) for no limit.\n */\nBullet.fire_rate = 250;\n\n/**\n * Bind to the \"shoot\" key(s) and create a new bullet.\n *\n * Change keyup to keydown to be able to hold down the shoot key.\n */\njQuery(document).keyup(keys.shoot.join(' '), function() {\n  var now = Date.now();\n  // Throttle bullet firing.\n  if (now &gt; (player._lastFired || 0) + Bullet.fireRate &amp;&amp; isAnimating()) {\n    player._lastFired = now;\n    // Shoot in the direction the player looked last (default to right).\n    var direction = player.lastLooked.length ? player.lastLooked : keys.right;\n    // Center on the player.\n    var x = player.x + player.width * 0.5,\n        y = player.y + player.height * 0.5;\n    // Add the new bullet to our Collection.\n    bullets.add(new Bullet(direction, x, y));\n  }\n});\n</code></pre>\n\n<p>There are a few things to note here. First, you can bind keyboard events to\nspecific key combinations by passing the key combinations as the first\nparameter to <code>keyup</code>/<code>keydown</code>/<code>keypress</code> events. Separate combinations to\nlisten for with spaces, and combine keys that need to be pressed at the same\ntime with a plus sign (+). For example, to listen to Shift + A or the Down\narrow key, you'd use <code>\"shift+a down\"</code> as the first parameter to <code>keyup()</code>,\n<code>keydown()</code>, or <code>keypress()</code>. Second, the <code>lastLooked</code> property on Actors and\ntheir descendants is an array of directions (like the ones you specified in the\n<code>keys</code> object) indicating the last direction in which the Actor looked. Third,\nwhen we initialize a new bullet by calling <code>new Bullet()</code>, the parameters we\npass to <code>Bullet()</code> go straight to the <code>Bullet.prototype.init()</code> function. And\nfinally, the <code>add()</code> method is one way to add things to a Collection.</p>\n\n<p>Also make sure to draw the bullets in the magic <code>draw()</code> function:</p>\n\n<pre><code>bullets.draw();\n</code></pre>\n\n<p>...and move them around in <code>update()</code>:</p>\n\n<pre><code>// The forEach() method runs the specified function on every item in the\n// Collection. forEach() can also take a string, which is interpreted as a\n// method name; for example, bullets.forEach('update') would execute each\n// bullet's \"update\" method.\n// TileMaps have a forEach() method as well that works the same way.\nbullets.forEach(function(bullet) {\n  bullet.update();\n  // Returning true removes the bullet from the collection.\n  // Destroy the bullet if it hits a solid or goes out of the world.\n  return bullet.collides(solid) || !world.isInWorld(bullet, true);\n});\n</code></pre>\n\n<p>Note that all Boxes have a <code>collides()</code> method which, like Actors'\n<code>collideSolid()</code> method, accepts a Box, Collection, or TileMap. By default it\nreturns the first item with which it overlaps, or <code>false</code> if it doesn't overlap\nwith anything. Also, the <code>world</code> object represents the entire map. We're\nalready using it in <code>setup()</code> where we resized the playable area with\n<code>world.resize()</code>. Here we're asking if the bullet is within the playable area,\nand if not, we're returning <code>true</code> to destroy it.</p>\n\n<p>That's it &mdash; we can now shoot bullets when we press the right key, and our\nbullets collide with our world geometry.</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/guides/walkthrough/screen04.png\" alt=\"Fireballs\" /></p>\n\n<p><strong>Quick recap:</strong> At this point we've got around 180 lines of code. We've got a\nplayer animated with sprites, a side-scrolling game world with gravity, level\ngeometry that supports images and collision, and the ability to shoot fireballs\nwhen we press keys on the keyboard. We've learned how to manage Boxes,\nCollections, TileMaps, drawing and updating, collision, classes and\ninheritance, gravity, keyboard input, and scrolling. In other words, we've\nlearned pretty much everything we need to make most games!</p>\n\n<p><em><a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/walkthrough05-inheritance.js\">Review the code for this section</a></em></p>\n\n<h2 id='walkthrough-section-layers'>Layers</h2>\n\n<p>So far, we've drawn everything directly onto the canvas in every frame of\nanimation. This works, but it's not very efficient. Our background (currently a\ncheckerboard) and our level geometry (the grass in our TileMap) don't ever\nmove, so they only need to be painted once, whereas the player and bullets move\nin practically every frame and need to be painted all the time. Also, at some\npoint we may want to draw text onto the screen as part of a HUD (Heads-Up\nDisplay) -- for example, to display the score and the player's remaining lives;\nand text renders very slowly, so having to render it in every frame will\nimmediately make our project unusable. To resolve this dilemma, we use\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/Layer\">Layer</a>s,\nwhich are intermediate canvases we can draw onto in order to cache the display\nand draw it more quickly onto the main canvas.</p>\n\n<p>We're going to create two layers: one for the background image and level\ngeometry and one for the HUD. Here's the code that goes at the bottom of\n<code>setup()</code>:</p>\n\n<pre><code>// Set up the static background layer.\n// By default, layers scroll with the world.\nbkgd = new Layer({src: 'path/to/image.png'});\nsolid.draw(bkgd.context);\n\n// Set up the Heads-Up Display layer.\n// This layer will stay in place even while the world scrolls.\nhud = new Layer({relative: 'canvas'});\nhud.context.font = '30px Arial';\nhud.context.textAlign = 'right';\nhud.context.textBaseline = 'top';\nhud.context.fillStyle = 'black';\nhud.context.strokeStyle = 'rgba(211, 211, 211, 0.5)';\nhud.context.lineWidth = 3;\nhud.context.strokeText('Score: 0', canvas.width - 15, 15);\nhud.context.fillText('Score: 0', canvas.width - 15, 15);\n</code></pre>\n\n<p>The <code>context</code> property of a Layer is a Canvas 2D Graphics Rendering Context.\nThat is, it's the same kind of thing you would use to draw if you didn't use\nthis framework and just built the whole thing from scratch. You can draw\ndirectly onto it with normal Canvas commands like we're doing here with\n<code>fillText()</code> and <code>strokeText()</code>. Boxes, Collections, and TileMaps all have\n<code>draw()</code> methods that take a graphics context as their first parameter (if you\ndon't pass anything they'll default to drawing onto the main canvas). We're\nusing this in our call to <code>solid.draw()</code>.</p>\n\n<p>While we're on the topic, note that H5CGB overrides the native\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/api/CanvasRenderingContext2D-method-drawImage\"><code>drawImage()</code></a>\nmethod for performance and flexibility. You can use it to draw almost anything\nefficiently onto the canvas or a Layer. The Box/Actor/Player, Collection, and\nTileMap <code>draw()</code> methods use this under the hood.</p>\n\n<p>We also need to change the magic <code>draw()</code> function to actually use our Layers:</p>\n\n<pre><code>function draw() {\n  bkgd.draw();\n  solid.draw();\n  player.draw();\n  bullets.draw();\n  hud.draw();\n}\n</code></pre>\n\n<p>Finally, make sure to add your background image's file path to the\n<code>preloadables</code> array.</p>\n\n<p>In addition to background and foreground caches, Layers are useful when a group\nof many independently-drawn entities needs to move together at once. You can\nsimply draw them one time onto a Layer and then draw that Layer as a single\nimage rather than rendering all its components again.</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/guides/walkthrough/screen05.png\" alt=\"Layers\" /></p>\n\n<p>Layers also support <a href=\"https://en.wikipedia.org/wiki/Parallax\">parallax</a>\nscrolling.</p>\n\n<p><em><a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/guides/walkthrough/walkthrough06-layers.js\">Review the code for this section</a></em></p>\n\n<h2 id='walkthrough-section-exercises-for-the-reader'>Exercises for the Reader</h2>\n\n<p>We've now gone through all the rapid prototyping tools that are useful in\nsetting up a platformer game. (We have not used every feature that each tool\nprovides &mdash; for that, take a look at the full documentation.) There are\nstill some features that are missing from the game we've built compared to the\nMario games, most notably enemies and coins. These can be written with the\ntools we've already encountered, so they're not covered here for brevity. It's\na good exercise to implement these features yourself. If you get stuck or want\nto see the end product, you can\n<a href=\"http://icecreamyou.github.com/HTML5-Canvas-Game-Boilerplate/examples/mario.html\">play with</a> or\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/blob/gh-pages/examples/mario.js\">read the code</a>\nof a more complete example.</p>\n\n<p><img src=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/raw/gh-pages/guides/walkthrough/screen06.png\" alt=\"Complete game\" /></p>\n\n<h2 id='walkthrough-section-recap'>Recap</h2>\n\n<p>We've implemented quite a lot of powerful features in under 200 lines of code.\nYour game is already fun to play with, and with some polish, it will be ready\nto show off to your friends!</p>\n\n<p>These tools are quite flexible and are useful in many different scenarios\nbeyond a Mario game. You can\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/\">read the complete API reference</a> or\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate/wiki/What%27s-Included-&amp;-API-Overview\">view a comprehensive feature list</a>\nto get more familiar with them. Also feel free to dig through the code; it's\nwell-documented.</p>\n\n<p>The one major feature set we didn't cover is mouse interactions. There is a lot\nto cover there, so it is addressed in a\n<a href=\"http://icecreamyou.github.io/HTML5-Canvas-Game-Boilerplate/docs/#!/guide/mouse\">separate tutorial</a>.</p>\n\n<p>Congratulations! Go\n<a href=\"https://github.com/IceCreamYou/HTML5-Canvas-Game-Boilerplate\">get the code</a> if\nyou haven't already, and build something awesome!</p>\n","title":"Walkthrough: Basics"});